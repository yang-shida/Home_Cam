<!-- http://192.168.1.108:81/esp32_cam_stream -->
<!-- `http://192.168.1.108/esp32_cam_capture?cb=${new Date().getTime()}` -->

<img id="display">

<script>
    const CAM_IP = "http://192.168.50.197"

    var intervalID
    var image
    var lastURL

    fetch(`${CAM_IP}/esp32_cam_control?var=framesize&val=9`)
    .then(()=>{
        intervalID = window.setInterval(myCallback, 100);
        image = document.getElementById("display");
    })
    



    function myCallback() {
        fetch(`${CAM_IP}/esp32_cam_capture?cb=${new Date().getTime()}`)
        .then((res)=>{
            return res.blob()
        })
        .then(imageBlob=>{
            const imageObjectURL = URL.createObjectURL(imageBlob);
            image.src=imageObjectURL
            lastURL=imageObjectURL
        })
        .catch((err)=>{
            image.src=lastURL
        })
    }
</script>

